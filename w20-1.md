https://code-live.ru/post/chat-with-tornado-backbone-and-websockets/
Пишем чат на Tornado, Backbone и веб-сокетах
https://github.com/selevit/tornado-chat
Simple asyncronous chat written on Tornado
==========================================

> cd c:\ve\w20
>V	python -m venv myvenv
>A	myvenv\Scripts\activate
>U	python -m pip install --upgrade pip
> cd c:\ve\w20\chat
> pip install -r requirements.txt
> pip freeze
backports-abc==0.5
certifi==2016.9.26
futures==3.0.5
motor==1.0
pymongo==3.3.1
singledispatch==3.4.0.3
six==1.10.0
tornado==4.4.2
(myvenv) Viva@VIVAN c:\ve\w20\chat
>
//rem python server.py
Server will available on localhost:8888:

copy .gitignore !!!!!! не забывай
PyCharm: open w20

Настройка окружения
===================

Для хранения сообщений чата мы будем использовать базу данных MongoDB. Установим саму Mongo и ее драйвер для python — pymongo.

sudo apt-get install mongodb	!!! vv: вот где собака порылась !!!	<<<<<<<<<<<<<<<<<<<<<<<<<,
//уже есть 3.3.1	pip install pymongo==3.2.1

Серверная часть
===============

Напишем backend для нашего чата на Tornado. Сервер обработки сообщений будет слушать соединения на 8888-порту и добавлять идентификаторы всех активных клиентов в список WebSocketsPool. Когда сервер получает сообщение от клиента, оно сохраняется в базу. Затем рассылаются уведомления о новом сообщении всем остальным участникам беседы.

Таким образом, мы сможем достичь realtime-обновления чата у всех пользователей. В директории tornado-chat создайте файл server.py со следующим содержимым:

vv: заменил тескт файла текстом из статьи
...

Шаблон HTML
===========

Класс MainHandler необходим для формирования HTML-страницы со списком сообщений и формой. В нашем шаблоне нет ничего интересного. Скопируйте его исходный код из репозитория на github в файл index.html.

Клиентская логика приложения
===========================

Создайте директорию static в корне проекта. Там будут находиться статические файлы нашего чата — картинки, стили и скрипты.

Наш скрипт будет обрабатывать событие отправки формы и формировать объект, содержащий ник автора и текст самого сообщения.

После чего сообщение будет передаваться серверу в формате JSON. Сервер же, в свою очередь сохранит его в базу данных и отправит уведомления всем остальным участникам конференции.

При уведомлении о новом сообщении будет вызываться событие onmessage из класса WebSocket. Само сообщение будет передаваться клиентам, также, в формате JSON, а затем преобразовываться в объект javascript с помощью функции JSON.parse.

При вызове события onmessage, новое сообщения добаляется в чат. Для создания красивой архитектуры скрипта мы воспользуемся библиотекой Backbone.js. Если читатель еще не знаком с Backbone, то самое время познакомиться с этим фреймворком поближе.

Создайте новую директорию static/js и добавьте туда новый файл main.js:

...

Внешний вид
===========

Для оформления внешнего вида страницы над понадобится CSS фреймворк Twitter-Bootstrap. Скачайте последнюю версию библиотеки и распакуйте архив в директорию static/lib нашего проекта.

Создайте файл style.css внутри директории static/css. Содержимое файла стилей возьмите из репозитория на github.

Запуск Tornado
==============

В корне проекта из консоли запустите следующие команды:

source env/bin/activate
python server.py
Первая команда активирует виртуальное окружение, созданное ранее с помощью virtualenv. В самом начале мы уже активировали его. Автор оставил эту команду здесь на тот случай, если читатель перезапустил свой shell, и случайно забыл про активацию окружения.

Вторая команда — python server.py запускает сервер Tornado, который обеспечивает работу нашего чата.

Не забудьте про запуск сервера MongoDB, если он не стартовал автоматически после установки.

vv:
Viva@VIVAN C:\Users\Viva
$ mongod --dbpath C:\mongodb\data\db		<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

В Ubuntu/Debian Mongo запускается следующим образом:

sudo service mongodb start			<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
В Gentoo:

sudo rc-service mongodb start			<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

Теперь откройте чат в браузере, который поддерживает вебсокеты: 
http://127.0.0.1:8888/

================================================

open tornado-chat\server.py
Run > Run > server: Run

OK

PyCharm:	VCS > Import Version Control > Share Project on GitHub	> w20	> Share > OK
